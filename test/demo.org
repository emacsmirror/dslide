#+title:	DSL IDE
#+author:	Positron
#+email:	contact@positron.solutions

* Start
1. Run =M-x= ~dslide-presentation-start~.
2. Press the right arrow key ‚û°Ô∏è
** Controls
:PROPERTIES:
:DSLIDE_SECTION_ACTIONS: dslide-action-item-reveal
:END:
See the ~dslide-mode-map~ but basically, arrow keys.
- ‚û°Ô∏è ~dslide-presentation-forward~
- ‚¨ÖÔ∏è ~dslide-presentation-backward~
- ‚¨ÜÔ∏è ~dslide-presentation-start~ (default secondary action shows contents)
- ‚¨áÔ∏è ~dslide-presentation-stop~
* Customization
View customize variables by calling =M-x customize-group RET dslide=
** Slide Actions
Slide actions are configured using the heading's property drawer.
** Hiding Markup
Check out ~mc-hide-markup-mode~ in the [[https://github.com/positron-solutions/master-of-ceremonies][master-of-ceremonies]] package.
** Steezing to Org Markup
The setup used for the Positron's YouTube demos is not much more complex than this well-documented setup by [[https://systemcrafters.net/emacs-tips/presentations-with-org-present/][System Crafters]].  Also see Prot's [[https://protesilaos.com/codelog/2020-07-17-emacs-mixed-fonts-org/][further]] documentation on customizing org mode faces and fonts.

In short, use:
- ~org-modern~
- ~org-appear~
- ~nerd-icons~ for more cheesy Óò≤(Emacs logo)
- And set the faces for org headings and document title.

Don't forget built-in ~emoji-search~ and searching ~insert-char~.

Positron is cheating and also apply custom line-spacing and line-height.  While Psionic maintains a custom ~org-modern~, using custom spacing everywhere fights with ~visual-line-mode~ currently.
** Bindings
Bind the command ~dslide-presentation-start~ in the ~org-mode-map~.  Any key will do.
** Custom Actions
:PROPERTIES:
:DSLIDE_SECTION_ACTIONS: dslide-action-babel
:END:
The babel block below is a custom action supporting both forward, each step making a paragraph red when going forward or removing the red when going backward.

#+attr_dslide: begin end
#+begin_src elisp

  (defclass dslide-action-red-paragraphs (dslide-action)
    ((overlays :initform nil))
    "Paint the paragraphs red, one by one.")

  ;; Default no-op `dslide-init' is sufficient

  ;; Default implementation of `dslide-end', which just plays forward to the end,
  ;; is well-behaved with this class.

  ;; Remove any remaining overlays when calling final.
  (cl-defmethod dslide-final :after ((obj dslide-action-red-paragraphs))
    (mapc #'delete-overlay (oref obj overlays)))

  ;; Find the next paragraph and add an overlay if it exists
  (cl-defmethod dslide-forward ((obj dslide-action-red-paragraphs))
    (when-let ((paragraph (dslide-section-next obj 'paragraph)))
      (let* ((beg (org-element-property :begin paragraph))
             (end (org-element-property :end paragraph))
             (new-overlay (make-overlay beg end)))
        (overlay-put new-overlay 'face 'error)
        (push new-overlay (oref obj overlays))
        ;; Return non-nil to indicate progress was made.  This also informs the
        ;; highlight when following the slides in the base buffer.
        beg)))

  (cl-defmethod dslide-backward ((obj dslide-action-red-paragraphs))
    (when-let* ((overlay (pop (oref obj overlays))))
      (delete-overlay overlay))
    ;; If there is a preceding overlay, move to its beginning else move to the
    ;; beginning of the heading.
    (if-let ((overlay (car (oref obj overlays))))
        (prog1 t
          (dslide-marker obj (overlay-start overlay)))
      (dslide-marker obj (org-element-property :begin (dslide-heading obj)))))
#+end_src
*** Custom Action Demo
:PROPERTIES:
:DSLIDE_SECTION_ACTIONS: dslide-action-red-paragraphs
:END:
Massachusetts, in particular, has always been one of the laboratories of democracy. It's where people try things before they're popular. It's where we experiment.

Democracy depends on an informed citizenry and the social cohesion that those citizens can show even when they disagree.

The essence of democracy is the resolve of individuals working together to shape our institutions and our society in ways that allow all of us to flourish.
* Follow Along
This presentation is shown in an indirect buffer.  See the mode line.  The buffer name should be =deck: demo.org= or something similar.

Split the window =C-x 3= or ~split-window-right~ and switch to the base buffer, =demo.org=

When you advance with ~dslide-presentation-forward~, you can see the presentation's progress point highlighted in the base buffer.  This makes it easier to debug babel blocks and other actions.
* Contents
Call ~dslide-presentation-start~ during an already running presentation to start the "secondary" action.  Later this might mean playing a video etc.  By default it will display the contents.
* Breadcrumbs
This information goes deep
** Deep
And it will go deeper still yet
*** Deeper
The rabbit hole has only the bounds of your imagination
**** Deepest?
Wow, these breadcrumbs are very high-carb
***** Okay Deep Enough!
How many levels of headings could there be?
* Inline Children
:PROPERTIES:
:DSLIDE_CHILD_ACTION: dslide-child-action-inline
:END:
- You won't believe these animations
- This is the world's greatest presentation software
  + But mainly because it integrates with all you programming tools
** Pen üñäÔ∏è
Information, you have to breathe it in
** Pineapple üçç
Isn't this animation so cool?
** Apple üçé
This is a reason to be alive
** Pen üñäÔ∏è
[[https://www.youtube.com/watch?v=Ct6BUPvE2sM][In case you live under a rock]]
* Flat Slide
:PROPERTIES:
:DSLIDE_SLIDE_ACTION: dslide-action-narrow :with-children t
:DSLIDE_CHILD_ACTION: nil
:END:
This slide shows its child headings inline.
- The slide action shows the entire contents, not just the section
- There is no child action
** Blue Team
- Has to do all the work
- Must create an air-tight submarine
** Red Team
- Uses some metasploit and calls it a day
- Failure is an option
* Reveal Items
:PROPERTIES:
:DSLIDE_SECTION_ACTIONS: dslide-action-item-reveal
:END:
Positron is deeply committed to bringing you the finest in:
- Pen üñäÔ∏è
- Pineapple üçç
- Apple üçé
- Pen üñäÔ∏è
* Image Slides
:PROPERTIES:
:DSLIDE_SECTION_ACTIONS: dslide-action-image
:END:
This is an image slide.  You can view the images inline using ~org-toggle-inline-images~.  Each image will be opened in a full-screen buffer, which is configured to act as a slide, so it still responds to the keybindings.

#+ATTR_HTML: :width 45%
 [[./images/emacsen4.jpeg]] [[./images/self-care5.jpeg]]
#+ATTR_HTML: :width 45%
 [[./images/before-google3.jpeg]] [[./images/all-software-is-the-same-with-tang.jpeg]]
* Babel Slide Integration
:PROPERTIES:
:DSLIDE_SECTION_ACTIONS: dslide-action-babel
:END:

Both backwards and forward are supported on this slide.

#+attr_dslide: begin end
#+begin_src elisp :results none
  (setq-local overlays nil)
  (goto-char (point-min))
  (while (re-search-forward "overlay" nil t)
    (let ((overlay (make-overlay (match-beginning 0)
                                 (match-end 0))))
      (push overlay overlays)))
#+end_src

#+attr_dslide: backward
#+begin_src elisp :results none
  (mapc (lambda (o) (overlay-put o 'display nil)) overlays)
#+end_src

#+attr_dslide: both
#+begin_src elisp :results none
  (mapc (lambda (o) (overlay-put o 'display "ü•û")) overlays)
#+end_src

#+attr_dslide: both
#+begin_src elisp :results none
  (mapc (lambda (o) (overlay-put o 'display "ü•ûü•û")) overlays)
#+end_src

#+attr_dslide: forward end
#+begin_src elisp :results none
  (mapc (lambda (o) (overlay-put o 'display "ü•ûü•ûü•û")) overlays)
#+end_src

#+attr_dslide: final
#+begin_src elisp :results none
  (mapc #'delete-overlay overlays)
  (makunbound 'overlays)
#+end_src
* Hidden Babel Slide
This slide has a child, but it will not be displayed.  It will only run the babel block within, which finds and updates the text below:

Can has display?
** No Display!  Only Execute!
:PROPERTIES:
:DSLIDE_SLIDE_ACTION: nil
:DSLIDE_SECTION_ACTIONS: dslide-action-babel
:END:
These four org blocks will not be displayed since this slide has no slide action.  They will however execute when navigating forward and backward.  Note these features:

- Blocks can have methods
- Multiple blocks can have the begin, end, and final method.  They are always executed top to bottom.  This allows better code re-use.

#+attr_dslide: end begin
#+begin_src elisp :results none
  ;; No need to deal with restriction or restore point.
  (org-up-heading-safe)
  (if (re-search-forward "\?" nil t)
      (setq-local dslide-can-has-overlay
                  (make-overlay (match-end 0) (match-end 0)))
    (message "Ouchie, the document changed!"))
#+end_src

Some extra setup that can also be returned to with step backwards
#+attr_dslide: begin backward
#+begin_src elisp :results none
  (overlay-put dslide-can-has-overlay 'after-string
               (propertize "  No display!  Only execute!"
                           'face 'error))
#+end_src

When going backwards, we begin at the end, which can also be stepped forwards to
#+attr_dslide: forward end
#+begin_src elisp :results none
  (overlay-put dslide-can-has-overlay 'after-string
               (propertize "  No display!  Only execute!"
                           'face 'success))
#+end_src

Our cleanup is always run, after everything
#+attr_dslide: final
#+begin_src elisp :results none
  (when (bound-and-true-p dslide-can-has-overlay)
    (delete-overlay dslide-can-has-overlay)
    (makunbound 'dslide-can-has-overlay))
#+end_src
* Package Integration
:PROPERTIES:
:DSLIDE_SECTION_ACTIONS: dslide-action-babel
:END:
- You need the ~master-of-ceremonies~ package installed to complete this slide.
- Let arbitrary buffers be shown while still completing steps within the slide-show.
- Run babel against other buffers üòà.

#+attr_dslide: begin
#+begin_src elisp :results none
  (require 'master-of-ceremonies)
#+end_src
#+attr_dslide: final backward
#+begin_src elisp :results none
  (when-let ((buffer (get-buffer "*MC Focus*")))
    (kill-buffer buffer))
#+end_src

#+attr_dslide: both
  #+begin_src elisp :results none
  (mc-focus "üñäÔ∏è")
  #+end_src
#+attr_dslide: both
#+begin_src elisp :results none
  (mc-focus "üñäÔ∏èüçç")
  #+end_src
#+attr_dslide: both
#+begin_src elisp :results none
  (mc-focus "üñäÔ∏èüççüçé")
  #+end_src
#+attr_dslide: both
#+begin_src elisp :results none
  (mc-focus "üñäÔ∏èüççüçéüñäÔ∏è")
  #+end_src
* Thanks for Watching
- Publishing after some cleanup refactoring
- Should show up on MELPA and Non-GNU MELPA
- Using this in my own videos
